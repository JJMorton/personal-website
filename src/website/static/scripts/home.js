// `NOISE` is a 50x50 array of random numbers between 0 and 1
const NOISE_SIZE = 50;
const NOISE = [
	[0.852,0.399,0.272,0.914,0.567,0.705,0.775,0.793,0.316,0.239,0.091,0.614,0.865,0.288,0.872,0.371,0.382,0.132,0.350,0.558,0.750,0.725,0.008,0.288,0.146,0.881,0.023,0.394,0.199,0.374,0.144,0.020,0.159,0.810,0.548,0.205,0.314,0.785,0.626,0.352,0.911,0.240,0.297,0.413,0.773,0.156,0.711,0.024,0.624,0.326],
	[0.036,0.395,0.226,0.361,0.255,0.629,0.039,0.678,0.294,0.109,0.568,0.073,0.775,0.324,0.922,0.773,0.972,0.110,0.056,0.245,0.085,0.538,0.485,0.880,0.592,0.279,0.550,0.632,0.430,0.982,0.590,0.243,0.883,0.729,0.078,0.244,0.023,0.265,0.235,0.656,0.538,0.195,0.827,0.795,0.832,0.730,0.637,0.697,0.282,0.834],
	[0.011,0.578,0.449,0.555,0.091,0.767,0.127,0.866,0.506,0.227,0.849,0.766,0.448,0.816,0.677,0.315,0.935,0.220,0.467,0.397,0.671,0.560,0.715,0.325,0.334,0.389,0.562,0.413,0.368,0.326,0.091,0.397,0.497,0.052,0.986,0.969,0.304,0.784,0.801,0.133,0.165,0.515,0.999,0.908,0.205,0.253,0.482,0.555,0.457,0.047],
	[0.465,0.078,0.605,0.449,0.027,0.935,0.965,0.487,0.348,0.468,0.183,0.652,0.340,0.847,0.712,0.581,0.797,0.199,0.092,0.629,0.100,0.265,0.353,0.554,0.614,0.294,0.919,0.990,0.236,0.965,0.403,0.168,0.491,0.031,0.670,0.436,0.419,0.635,0.725,0.816,0.994,0.295,0.384,0.408,0.444,0.417,0.266,0.315,0.827,0.439],
	[0.819,0.373,0.310,0.716,0.244,0.691,0.705,0.957,0.501,0.612,0.807,0.161,0.934,0.458,0.579,0.276,0.606,0.136,0.477,0.290,0.975,0.186,0.877,0.331,0.839,0.493,0.646,0.722,0.877,0.008,0.577,0.866,0.474,0.070,0.729,0.701,0.251,0.596,0.037,0.445,0.873,0.614,0.144,0.462,0.205,0.899,0.857,0.326,0.146,0.316],
	[0.422,0.227,0.345,0.048,0.163,0.330,0.714,0.063,0.651,0.003,0.995,0.341,0.593,0.903,0.024,0.581,0.698,0.655,0.219,0.149,0.560,0.745,0.773,0.462,0.874,0.665,0.064,0.983,0.433,0.923,0.557,0.964,0.093,0.437,0.731,0.735,0.085,0.189,0.077,0.153,0.517,0.615,0.001,0.955,0.238,0.907,0.365,0.143,0.842,0.664],
	[0.577,0.296,0.400,0.870,0.836,0.383,0.561,0.914,0.744,0.724,0.634,0.065,0.998,0.002,0.119,0.557,0.827,0.132,0.924,0.196,0.732,0.409,0.381,0.886,0.689,0.256,0.858,0.972,0.857,0.074,0.654,0.832,0.935,0.944,0.047,0.388,0.826,0.666,0.150,0.260,0.090,0.362,0.972,0.472,0.810,0.534,0.660,0.972,0.248,0.033],
	[0.677,0.954,0.695,0.486,0.478,0.563,0.291,0.120,0.222,0.480,0.097,0.705,0.513,0.651,0.392,0.448,0.210,0.300,0.766,0.759,0.136,0.403,0.870,0.738,0.733,0.153,0.504,0.504,0.440,0.840,0.505,0.962,0.147,0.547,0.102,0.825,0.865,0.405,0.340,0.350,0.386,0.519,0.545,0.217,0.577,0.311,0.543,0.266,0.092,0.212],
	[0.172,0.547,0.521,0.379,0.986,0.990,0.836,0.135,0.296,0.274,0.584,0.223,0.616,0.123,0.322,0.169,0.810,0.119,0.601,0.286,0.588,0.085,0.426,0.091,0.554,0.261,0.258,0.793,0.899,0.229,0.154,0.899,0.649,0.888,0.010,0.509,0.511,0.462,0.226,0.278,0.214,0.428,0.671,0.217,0.397,0.383,0.750,0.138,0.934,0.195],
	[0.075,0.097,0.840,0.800,0.407,0.923,0.328,0.797,0.043,0.355,0.333,0.618,0.078,0.665,0.970,0.607,0.924,0.277,0.155,0.818,0.715,0.599,0.491,0.091,0.830,0.621,0.476,0.758,0.752,0.835,0.708,0.168,0.456,0.448,0.609,0.075,0.919,0.354,0.240,0.457,0.181,0.163,0.249,0.816,0.928,0.996,0.948,0.200,0.456,0.950],
	[0.460,0.560,0.983,0.274,0.554,0.406,0.707,0.236,0.850,0.481,0.612,0.571,0.777,0.269,0.421,0.956,0.776,0.537,0.296,0.817,0.565,0.757,0.805,0.444,0.397,0.273,0.863,0.743,0.549,0.631,0.924,0.085,0.599,0.505,0.287,0.945,0.605,0.955,0.496,0.221,0.172,0.052,0.995,0.874,0.156,0.149,0.104,0.482,0.607,0.016],
	[0.240,0.122,0.613,0.337,0.272,0.415,0.298,0.214,0.395,0.845,0.309,0.386,0.625,0.699,0.086,0.244,0.368,0.928,0.494,0.577,0.930,0.190,0.585,0.678,0.545,0.889,0.350,0.474,0.056,0.551,0.110,0.860,0.466,0.279,0.124,0.516,0.424,0.315,0.169,0.859,0.091,0.156,0.825,0.434,0.330,0.628,0.205,0.880,0.840,0.666],
	[0.733,0.155,0.826,0.560,0.185,0.958,0.545,0.039,0.112,0.553,0.349,0.892,0.765,0.114,0.953,0.021,0.965,0.676,0.865,0.123,0.932,0.981,0.425,0.634,0.455,0.871,0.868,0.190,0.030,0.580,0.714,0.425,0.369,0.210,0.858,0.653,0.929,0.506,0.568,0.386,0.995,0.953,0.034,0.624,0.258,0.657,0.188,0.212,0.013,0.589],
	[0.587,0.656,0.333,0.741,0.566,0.721,0.056,0.906,0.283,0.890,0.722,0.234,0.172,0.820,0.135,0.414,0.123,0.102,0.078,0.313,0.804,0.902,0.315,0.178,0.393,0.488,0.879,0.729,0.879,0.842,0.942,0.963,0.569,0.737,0.898,0.184,0.439,0.087,0.382,0.428,0.363,0.095,0.760,0.922,0.539,0.531,0.920,0.750,0.418,0.109],
	[0.388,0.353,0.159,0.105,0.211,0.072,0.873,0.250,0.694,0.977,0.731,0.044,0.183,0.882,0.854,0.802,0.134,0.314,0.998,0.721,0.710,0.951,0.549,0.121,0.633,0.540,0.678,0.838,0.689,0.619,0.361,0.020,0.313,0.483,0.791,0.728,0.913,0.100,0.475,0.330,0.160,0.047,0.243,0.593,0.117,0.067,0.447,0.750,0.022,0.117],
	[0.047,0.998,0.577,0.347,0.465,0.926,0.786,0.475,0.525,0.455,0.899,0.277,0.830,0.124,0.814,0.221,0.510,0.552,0.189,0.985,0.270,0.518,0.749,0.541,0.915,0.669,0.136,0.901,0.475,0.486,0.312,0.855,0.344,0.373,0.050,0.617,0.429,0.083,0.058,0.009,0.907,0.337,0.849,0.027,0.972,0.182,0.003,0.930,0.920,0.582],
	[0.241,0.200,0.838,0.523,0.243,0.907,0.732,0.593,0.585,0.968,0.001,0.587,0.711,0.011,0.282,0.871,0.288,0.371,0.660,0.639,0.718,0.666,0.326,0.138,0.331,0.949,0.843,0.146,0.326,0.913,0.190,0.971,0.904,0.802,0.055,0.802,0.420,0.331,0.600,0.843,0.987,0.912,0.496,0.512,0.711,0.153,0.173,0.280,0.629,0.290],
	[0.257,0.120,0.686,0.668,0.421,0.875,0.497,0.983,0.502,0.145,0.645,0.868,0.150,0.073,0.272,0.907,0.374,0.903,0.015,0.227,0.196,0.686,0.244,0.810,0.171,0.089,0.258,0.677,0.010,0.462,0.929,0.713,0.995,0.699,0.743,0.584,0.442,0.253,0.480,0.656,0.560,0.426,0.436,0.142,0.778,0.090,0.897,0.520,0.126,0.568],
	[0.233,0.711,0.542,0.062,0.266,0.973,0.713,0.071,0.100,0.617,0.054,0.304,0.104,0.025,0.333,0.369,0.182,0.307,0.490,0.754,0.659,0.582,0.473,0.188,0.112,0.808,0.769,0.348,0.734,0.914,0.111,0.082,0.087,0.330,0.559,0.756,0.888,0.584,0.128,0.016,0.527,0.700,0.077,0.477,0.792,0.669,0.294,0.706,0.407,0.208],
	[0.776,0.749,0.087,0.016,0.686,0.892,0.784,0.908,0.015,0.268,0.916,0.608,0.856,0.418,0.569,0.806,0.934,0.976,0.226,0.874,0.870,0.771,0.719,0.450,0.400,0.811,0.172,0.982,0.200,0.556,0.815,0.213,0.320,0.104,0.359,0.561,0.288,0.326,0.389,0.708,0.438,0.629,0.777,0.742,0.303,0.125,0.848,0.665,0.211,0.317],
	[0.941,0.021,0.516,0.777,0.136,0.254,0.128,0.039,0.589,0.352,0.507,0.326,0.250,0.781,0.765,0.209,0.253,0.947,0.782,0.651,0.953,0.876,0.042,0.241,0.364,0.362,0.673,0.117,0.562,0.049,0.165,0.908,0.548,0.457,0.654,0.234,0.396,0.631,0.945,0.439,0.076,0.423,0.879,0.905,0.303,0.670,0.899,0.045,0.323,0.487],
	[0.979,0.122,0.443,0.396,0.730,0.607,0.856,0.360,0.395,0.592,0.275,0.915,0.455,0.966,0.513,0.884,0.740,0.258,0.262,0.032,0.814,0.539,0.583,0.656,0.211,0.546,0.087,0.514,0.050,0.282,0.733,0.289,0.578,0.893,0.087,0.931,0.143,0.863,0.822,0.217,0.215,0.568,0.027,0.370,0.564,0.323,0.204,0.685,0.143,0.052],
	[0.349,0.480,0.013,0.949,0.007,0.433,0.343,0.223,0.623,0.230,0.486,0.638,0.987,0.628,0.638,0.999,0.567,0.366,0.858,0.942,0.240,0.897,0.045,0.307,0.114,0.760,0.552,0.640,0.738,0.992,0.396,0.032,0.510,0.822,0.889,0.608,0.709,0.201,0.135,0.821,0.854,0.460,0.271,0.233,0.946,0.601,0.344,0.112,0.988,0.199],
	[0.161,0.224,0.555,0.172,0.642,0.249,0.365,0.429,0.146,0.367,0.253,0.849,0.223,0.327,0.061,0.204,0.984,0.802,0.832,0.669,0.077,0.080,0.620,0.712,0.158,0.987,0.085,0.187,0.144,0.698,0.607,0.053,0.383,0.069,0.059,0.330,0.818,0.473,0.648,0.673,0.705,0.660,0.521,0.259,0.269,0.615,0.437,0.805,0.399,0.641],
	[0.322,0.152,0.262,0.035,0.053,0.900,0.502,0.796,0.612,0.385,0.915,0.648,0.302,0.881,0.499,0.741,0.260,0.332,0.541,0.113,0.970,0.266,0.618,0.954,0.727,0.894,0.944,0.208,0.790,0.180,0.864,0.649,0.763,0.064,0.665,0.597,0.573,0.641,0.530,0.501,0.854,0.232,0.893,0.376,0.985,0.472,0.999,0.536,0.531,0.826],
	[0.099,0.447,0.813,0.331,0.867,0.209,0.997,0.977,0.515,0.835,0.164,0.817,0.024,0.118,0.277,0.749,0.375,0.649,0.974,0.701,0.659,0.780,0.155,0.660,0.765,0.386,0.666,0.369,0.349,0.812,0.758,0.787,0.469,0.289,0.788,0.914,0.923,0.961,0.498,0.089,0.918,0.082,0.993,0.573,0.623,0.435,0.352,0.310,0.055,0.644],
	[0.571,0.514,0.984,0.375,0.430,0.728,0.043,0.557,0.700,0.949,0.415,0.604,0.872,0.317,0.343,0.789,0.583,0.097,0.178,0.395,0.773,0.019,0.640,0.968,0.886,0.082,0.635,0.273,0.194,0.252,0.269,0.136,0.933,0.401,0.205,0.060,0.870,0.555,0.884,0.972,0.692,0.415,0.031,0.550,0.904,0.614,0.850,0.111,0.570,0.690],
	[0.323,0.693,0.390,0.505,0.325,0.977,0.474,0.321,0.728,0.249,0.366,0.270,0.279,0.552,0.660,0.247,0.077,0.525,0.378,0.216,0.315,0.980,0.366,0.869,0.739,0.528,0.360,0.532,0.318,0.352,0.757,0.157,0.183,0.379,0.766,0.649,0.237,0.382,0.581,0.245,0.998,0.010,0.153,0.136,0.065,0.607,0.472,0.357,0.510,0.963],
	[0.560,0.910,0.556,0.733,0.428,0.098,0.234,0.916,0.541,0.948,0.478,0.940,0.418,0.983,0.057,0.009,0.804,0.452,0.538,0.203,0.852,0.752,0.492,0.039,0.154,0.050,0.584,0.818,0.368,0.669,0.114,0.657,0.444,0.836,0.320,0.607,0.727,0.052,0.675,0.713,0.194,0.317,0.267,0.128,0.240,0.402,0.980,0.795,0.197,0.398],
	[0.340,0.650,0.056,0.383,0.757,0.685,0.407,0.812,0.473,0.440,0.305,0.345,0.459,0.268,0.328,0.660,0.653,0.396,0.132,0.570,0.263,0.865,0.172,0.224,0.742,0.149,0.547,0.175,0.736,0.176,0.607,0.464,0.635,0.049,0.769,0.855,0.104,0.197,0.874,0.838,0.800,0.308,0.755,0.251,0.063,0.404,0.555,0.777,0.477,0.850],
	[0.018,0.971,0.095,0.728,0.939,0.005,0.872,0.971,0.620,0.047,0.899,0.593,0.759,0.340,0.963,0.691,0.543,0.040,0.022,0.026,0.221,0.023,0.608,0.602,0.397,0.086,0.398,0.100,0.113,0.241,0.869,0.535,0.402,0.709,0.070,0.698,0.326,0.065,0.299,0.926,0.972,0.703,0.077,0.243,0.942,0.814,0.074,0.054,0.351,0.178],
	[0.452,0.317,0.971,0.054,0.950,0.871,0.639,0.416,0.293,0.467,0.486,0.649,0.492,0.799,0.288,0.105,0.078,0.129,0.753,0.238,0.666,0.615,0.120,0.043,0.351,0.360,0.664,0.858,0.883,0.851,0.979,0.500,0.074,0.614,0.605,0.782,0.722,0.641,0.767,0.205,0.710,0.828,0.511,0.911,0.091,0.375,0.591,0.434,0.424,0.925],
	[0.195,0.882,0.723,0.204,0.911,0.589,0.823,0.605,0.913,0.664,0.413,0.135,0.419,0.604,0.673,0.960,0.611,0.247,0.865,0.474,0.714,0.100,0.765,0.986,0.735,0.856,0.518,0.817,0.079,0.038,0.996,0.655,0.598,0.097,0.408,0.535,0.267,0.437,0.068,0.824,0.134,0.945,0.775,0.197,0.530,0.436,0.813,0.227,0.485,0.783],
	[0.223,0.254,0.885,0.395,0.623,0.390,0.453,0.800,0.344,0.241,0.495,0.521,0.938,0.450,0.837,0.293,0.245,0.134,0.934,0.196,0.211,0.653,0.424,0.941,0.392,0.184,0.716,0.462,0.488,0.823,0.989,0.542,0.385,0.742,0.921,0.791,0.139,0.589,0.226,0.331,0.566,0.862,0.995,0.676,0.209,0.661,0.725,0.104,0.854,0.733],
	[0.821,0.653,0.155,0.786,0.472,0.460,0.729,0.146,0.657,0.374,0.926,0.994,0.547,0.926,0.351,0.561,0.825,0.213,0.145,0.156,0.975,0.609,0.925,0.005,0.406,0.711,0.124,0.421,0.940,0.708,0.400,0.672,0.348,0.524,0.227,0.558,0.418,0.285,0.173,0.903,0.811,0.250,0.692,0.750,0.221,0.949,0.194,0.256,0.167,0.283],
	[0.514,0.331,0.974,0.468,0.558,0.998,0.516,0.314,0.747,0.075,0.732,0.554,0.212,0.882,0.051,0.203,0.233,0.870,0.121,0.415,0.946,0.620,0.039,0.520,0.423,0.775,0.888,0.769,0.450,0.651,0.243,0.208,0.099,0.438,0.366,0.578,0.222,0.748,0.401,0.600,0.674,0.494,0.221,0.366,0.229,0.952,0.201,0.092,0.960,0.904],
	[0.842,0.841,0.975,0.619,0.641,0.607,0.979,0.986,0.337,0.389,0.464,0.160,0.033,0.687,0.564,0.650,0.073,0.964,0.707,0.806,0.347,0.141,0.495,0.360,0.876,0.744,0.927,0.828,0.950,0.772,0.594,0.033,0.263,0.699,0.103,0.469,0.115,0.109,0.204,0.784,0.545,0.406,0.407,0.431,0.524,0.048,0.276,0.363,0.800,0.121],
	[0.176,0.533,0.195,0.947,0.058,0.908,0.602,0.600,0.740,0.397,0.121,0.182,0.733,0.387,0.726,0.704,0.873,0.115,0.198,0.080,0.595,0.516,0.217,0.126,0.190,0.952,0.746,0.295,0.260,0.537,0.435,0.855,0.449,0.998,0.917,0.280,0.364,0.948,0.155,0.976,0.484,0.040,0.237,0.301,0.417,0.981,0.818,0.948,0.320,0.500],
	[0.256,0.462,0.407,0.036,0.383,0.367,0.936,0.643,0.132,0.483,0.834,0.535,0.367,0.749,0.602,0.526,0.183,0.540,0.011,0.068,0.831,0.710,0.795,0.443,0.498,0.674,0.975,0.936,0.617,0.116,0.406,0.960,0.863,0.616,0.994,0.718,0.384,0.531,0.205,0.883,0.641,0.542,0.892,0.281,0.211,0.744,0.960,0.422,0.638,0.777],
	[0.818,0.754,0.269,0.054,0.672,0.361,0.021,0.045,0.808,0.229,0.138,0.603,0.659,0.053,0.811,0.869,0.590,0.115,0.672,0.734,0.615,0.416,0.773,0.034,0.740,0.036,0.124,0.406,0.335,0.899,0.475,0.194,0.419,0.987,0.811,0.417,0.400,0.718,0.942,0.246,0.442,0.204,0.797,0.489,0.506,0.875,0.931,0.869,0.265,0.252],
	[0.658,0.342,0.344,0.720,0.250,0.619,0.762,0.032,0.591,0.628,0.359,0.875,0.791,0.510,0.324,0.650,0.477,0.171,0.244,0.377,0.164,0.334,0.849,0.342,0.603,0.136,0.967,0.530,0.807,0.151,0.507,0.811,0.838,0.526,0.726,0.155,0.186,0.305,0.456,0.652,0.282,0.352,0.662,0.407,0.296,0.949,0.455,0.321,0.098,0.101],
	[0.885,0.144,0.956,0.832,0.323,0.674,0.833,0.191,0.319,0.024,0.477,0.436,0.805,0.309,0.242,0.868,0.640,0.362,0.129,0.156,0.067,0.530,0.045,0.148,0.506,0.860,0.370,0.706,0.471,0.960,0.414,0.264,0.100,0.847,0.590,0.443,0.857,0.055,0.163,0.036,0.257,0.429,0.763,0.657,0.677,0.544,0.670,0.691,0.764,0.981],
	[0.756,0.054,0.868,0.123,0.121,0.349,0.566,0.067,0.321,0.445,0.927,0.875,0.006,0.330,0.888,0.652,0.916,0.706,0.007,0.523,0.429,0.887,0.323,0.996,0.022,0.916,0.736,0.548,0.774,0.068,0.691,0.270,0.784,0.573,0.784,0.313,0.630,0.606,0.010,0.891,0.019,0.514,0.029,0.637,0.872,0.043,0.317,0.206,0.293,0.061],
	[0.864,0.589,0.147,0.287,0.839,0.135,0.396,0.241,0.900,0.729,0.158,0.776,0.715,0.732,0.572,0.801,0.384,0.890,0.102,0.582,0.621,0.004,0.660,0.218,0.256,0.715,0.051,0.710,0.625,0.269,0.810,0.291,0.902,0.503,0.942,0.007,0.712,0.114,0.457,0.344,0.346,0.092,0.542,0.098,0.130,0.777,0.131,0.611,0.976,0.535],
	[0.181,0.328,0.869,0.289,0.815,0.087,0.230,0.730,0.179,0.744,0.825,0.197,0.577,0.457,0.323,0.150,0.796,0.467,0.382,0.164,0.932,0.110,0.590,0.179,0.742,0.683,0.850,0.566,0.453,0.342,0.251,0.878,0.470,0.935,0.170,0.641,0.919,0.643,0.506,0.084,0.193,0.348,0.366,0.161,0.045,0.117,0.908,0.402,0.029,0.363],
	[0.490,0.156,0.525,0.803,0.842,0.722,0.090,0.808,0.211,0.300,0.125,0.878,0.676,0.227,0.952,0.606,0.039,0.632,0.504,0.988,0.825,0.336,0.767,0.552,0.461,0.413,0.608,0.007,0.050,0.032,0.601,0.138,0.482,0.994,0.062,0.804,0.744,0.923,0.994,0.153,0.012,0.409,0.675,0.383,0.411,0.607,0.776,0.757,0.696,0.974],
	[0.968,0.570,0.520,0.546,0.682,0.574,0.392,0.709,0.631,0.646,0.487,0.562,0.123,0.509,0.416,0.767,0.404,0.556,0.315,0.978,0.563,0.910,0.451,0.820,0.788,0.581,0.112,0.129,0.862,0.579,0.556,0.476,0.042,0.971,0.316,0.817,0.872,0.415,0.403,0.898,0.300,0.737,0.872,0.472,0.320,0.401,0.174,0.071,0.835,0.974],
	[0.249,0.231,0.164,0.869,0.174,0.206,0.380,0.726,0.075,0.579,0.890,0.626,0.288,0.581,0.987,0.659,0.476,0.343,0.674,0.571,0.795,0.653,0.730,0.191,0.942,0.715,0.620,0.043,0.177,0.528,0.711,0.350,0.156,0.905,0.543,0.033,0.796,0.723,0.476,0.561,0.124,0.501,0.181,0.306,0.849,0.147,0.226,0.847,0.413,0.086],
	[0.465,0.427,0.408,0.408,0.395,0.303,0.681,0.607,0.481,0.092,0.438,0.618,0.865,0.157,0.525,0.151,0.053,0.493,0.955,0.505,0.973,0.738,0.250,0.748,0.115,0.935,0.671,0.565,0.655,0.529,0.714,0.793,0.397,0.290,0.959,0.530,0.924,0.991,0.709,0.867,0.782,0.116,0.731,0.844,0.329,0.918,0.156,0.313,0.086,0.111],
	[0.390,0.267,0.498,0.739,0.677,0.636,0.174,0.945,0.907,0.725,0.130,0.023,0.751,0.698,0.535,0.737,0.282,0.691,0.531,0.354,0.282,0.148,0.778,0.305,0.851,0.624,0.788,0.246,0.077,0.414,0.780,0.012,0.779,0.386,0.337,0.836,0.440,0.853,0.601,0.116,0.687,0.419,0.399,0.016,0.754,0.356,0.417,0.349,0.760,0.427],
];

function ParticleCollection(width, height, dx, size = 2) {

	const nx = Math.floor(width / dx);
	const ny = Math.floor(height / dx);

	const particles = [];

	for (let ix = 0; ix < nx; ix++) {
		for (let iy = 0; iy < ny; iy++) {
			const x = ix * dx, y = iy * dx;
			const noiseX = 0.0;
			const noiseY = 0.0;
			// const noiseX = (NOISE[ix % NOISE_SIZE][iy % NOISE_SIZE] - 0.5) * dx;
			// const noiseY = (NOISE[iy % NOISE_SIZE][ix % NOISE_SIZE] - 0.5) * dx;
			particles.push([x + noiseX, y + noiseY]);
		}
	}
	console.log(`created ${particles.length} particles`);

	const velocity = [];
	const k = 4.0 * 2.0 * Math.PI / width;
	const A = 10.0;
	for (let ix = 0; ix < nx; ix++) {
		for (let iy = 0; iy < ny; iy++) {
			const x = ix * dx, y = iy * dx;
			velocity.push([
				// A * (Math.sin(k * x) + Math.cos(k * y)),
				// A * (Math.cos(k * x) + Math.sin(k * y)),
				0.0,
				A * Math.sin(k * x),
			]);
		}
	}

	this.renderWith = function(ctx) {
		for (const particle of particles) {
			const [x, y] = particle;
			ctx.fillRect(x, y, size, size);
		}
	};

	this.animate = function(t, dt) {
		for (let ix = 0; ix < nx; ix++) {
			for (let iy = 0; iy < ny; iy++) {
				const i = ix * ny + iy;
				const c = 5.0;
				const shiftx = Math.floor(c * t);
				const ivel = ((ix + shiftx) % nx) * ny + iy;
				particles[i][0] += dt * c * velocity[ivel][0];
				particles[i][1] += dt * c * velocity[ivel][1];
			}
		}
	}

}

window.addEventListener("load", function() {
	"use strict";

	const canvas = document.querySelector("canvas");
	const ctx = canvas.getContext("2d");

	let particles = new ParticleCollection(canvas.width, canvas.height, 20.0, 5);

	let lastFrame = performance.now() * 1e-3;

	const animate = function() {
		const time = performance.now() * 1e-3;
		const dt = time - lastFrame;
		// particles.animate(time, dt);
		ctx.clearRect(0, 0, canvas.width, canvas.height);
		ctx.fillStyle = "#ffffff30";
		particles.renderWith(ctx);
		lastFrame = time;
		window.requestAnimationFrame(animate);
	};

	window.requestAnimationFrame(animate);
	window.addEventListener("resize", () => {
		particles = new ParticleCollection(canvas.width, canvas.height, 20.0, 5);
	});

});
